import{d as S,r as n,o as L,a as o,c as a,b as t,j as g,w as E,v as O,i as T,P as l,p as $,e as q,_ as V}from"./index-1cb887ef.js";import{a as k}from"./axios-4a70c6fc.js";import{s as i}from"./Toast-913090e5.js";import"./SpinerComponent-0ffd577d.js";const ne="/assets/expert-8fa372ba.svg",ce="/assets/send-57a0127e.svg",h=m=>($("data-v-6f63379b"),m=m(),q(),m),U={class:"modal"},P={class:"modal-content"},z={key:0},A={key:0,class:"modal-title"},F={key:1,class:"modal-title"},H={key:2,class:"text-center mb-1"},j={key:0,class:"form-group"},D={class:"form-group"},Y={class:"form-group"},G={key:1,class:"form-group"},J={key:2,class:"my-4"},K=h(()=>t("p",{class:"text-xs"},[T("Al registrarte aceptas nuestros "),t("a",{href:"/terminos-y-condiciones",target:"_blank",class:"text-primary font-bold"},"términos y condiciones"),T(" y "),t("a",{href:"/politica-de-privacidad",target:"_blank",class:"text-primary font-bold"},"política de privacidad"),T(".")],-1)),Q=[K],W={key:5,class:"w-100 text-center mt-1"},X={key:6,class:"w-100 text-center mt-1"},Z={key:1},ee=h(()=>t("h2",null,"Limite alcanzado",-1)),se=h(()=>t("p",{class:"text-center mb-1"},"Has alcanzado el límite de consultas diarias, ¿quieres seguir usando el chat, considera contratar uno de nuestros planes.",-1)),te=[ee,se],w="https://api-chatbot.letsdoitnow.us/api",oe=S({__name:"LoginBot",props:{closeModal:Function},setup(m){const p=m,u=n(""),c=n(""),v=n(""),_=n(""),d=n(!1),C=n(!1),f=n(""),x=n(),M=n(!1),y=n(!1),b=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,I=()=>{u.value="",c.value="",v.value=""},B=async()=>{try{const s=await k.get(`${w}/user/temp`);s.status===200?(localStorage.setItem("session",s.data.token+"-"+s.data.user),p.closeModal&&p.closeModal(),window.location.reload()):i("Error al cargar","error",3e3,l.BOTTOM_CENTER)}catch{i("Error al cargar","error",3e3,l.BOTTOM_CENTER)}},N=async()=>{if(y.value=!0,!b.test(u.value))i("El email no es válido","error",3e3,l.BOTTOM_CENTER);else if(!_.value||!c.value||!v.value)i("Todos los campos son obligatorios","error",3e3,l.BOTTOM_CENTER);else if(c.value!==v.value)i("Las contraseñas no coinciden","error",3e3,l.BOTTOM_CENTER);else try{let s;f.value?s={userId:f.value,name:_.value,email:u.value,password:c.value}:s={name:_.value,email:u.value,password:c.value};let e=await k.post(`${w}/user`,s,{});localStorage.setItem("session",e.data.token+"-"+e.data.user),i("Registrado correctamente","success",2e3,l.BOTTOM_CENTER),p.closeModal&&p.closeModal(),setTimeout(()=>{window.location.reload()},1200),I()}catch(s){s.response.data.message=="A user with this email already exists."?i("Correo registrado","error",3e3,l.BOTTOM_CENTER):i(`Error al registrar ${s}`,"error",3e3,l.BOTTOM_CENTER)}y.value=!1},R=()=>{y.value=!0,b.test(u.value)?c.value?k.post(`${w}/login`,{email:u.value,password:c.value},{}).then(s=>{localStorage.setItem("session",s.data.token+"-"+s.data.user),i("Iniciado correctamente","success",2e3,l.BOTTOM_CENTER),p.closeModal&&p.closeModal(),setTimeout(()=>{window.location.reload()},1200),I()}).catch(s=>{s.response.data.message=="Invalid email or password."?i("Contraseña o correo incorrectos","error",3e3,l.BOTTOM_CENTER):i(`Error al iniciar ${s}`,"error",3e3,l.BOTTOM_CENTER)}):i("Todos los campos son obligatorios","error",3e3,l.BOTTOM_CENTER):i("El email no es válido","error",3e3,l.BOTTOM_CENTER),y.value=!1};return L(async()=>{if(localStorage.getItem("limit")&&(C.value=!0,localStorage.removeItem("limit")),localStorage.getItem("registerLimit")&&(M.value=!0,localStorage.removeItem("registerLimit")),localStorage.getItem("session")){const e=(localStorage.getItem("session")||"").split("-")||"";x.value=e.slice(0,e.length-1).toString(),f.value=e[e.length-1]}else x.value="",f.value=""}),(s,e)=>(o(),a("div",U,[t("div",P,[t("span",{class:"close",onClick:e[0]||(e[0]=r=>B())},"×"),M.value?(o(),a("div",Z,te)):(o(),a("div",z,[d.value?(o(),a("h2",A,"Iniciar sesión")):(o(),a("h2",F,"Registro")),C.value?(o(),a("p",H,"Has alcanzado el límite de consultas gratuitas, regístrate para continuar usando el chat y no perder el historial.")):g("",!0),t("div",null,[d.value?g("",!0):(o(),a("div",j,[E(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>_.value=r),type:"text",placeholder:"Nombre",required:""},null,512),[[O,_.value]])])),t("div",D,[E(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>u.value=r),type:"email",placeholder:"Email",required:""},null,512),[[O,u.value]])]),t("div",Y,[E(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>c.value=r),type:"password",placeholder:"Password",required:""},null,512),[[O,c.value]])]),d.value?g("",!0):(o(),a("div",G,[E(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>v.value=r),type:"password",placeholder:"Confirmar password",required:""},null,512),[[O,v.value]])])),d.value?g("",!0):(o(),a("div",J,Q)),d.value?(o(),a("button",{key:3,class:"submit",onClick:e[5]||(e[5]=r=>R())},"Iniciar sesión")):(o(),a("button",{key:4,class:"submit",onClick:e[6]||(e[6]=r=>N())},"Registrarse")),d.value?(o(),a("p",X,[T("¿No tienes cuenta? regístrate "),t("span",{class:"cursor-p text-primary font-bold",onClick:e[8]||(e[8]=r=>d.value=!1)},"aquí")])):(o(),a("p",W,[T("¿Ya tienes cuenta? inicia sesión "),t("span",{class:"cursor-p text-primary font-bold",onClick:e[7]||(e[7]=r=>d.value=!0)},"aquí")])),d.value?g("",!0):(o(),a("p",{key:7,class:"w-100 text-center mt-1 text-primary cursor-p",onClick:e[9]||(e[9]=r=>B())},"Continuar sin cuenta"))])]))])]))}});const de=V(oe,[["__scopeId","data-v-6f63379b"]]);export{de as L,ce as _,ne as a};
